#############################################################################################################
## MOD Title:		phpBB Garage 1.2.0
## MOD Author: poyntesm < esmond.poynton[at]gmail[dot]com > (Esmond Poynton) http://forums.phpbbgarage.com/
## MOD Description:
##			This mod allows users of your forum to add details about their vehicles.
##			Each user can store a configurable number of vehicles and the following data about them
##			- Vehicle Details (including images)
##			- Modifications (including images)
##			- QuarterMile Times (including images)
##			- Rolling Road Runs (including images)
##			- Insurance Premiums
##			- Vehicle Guestbook - Allowing other users leave comments
##			- Vehicle Ratings - Allowing other users to rate the vehicle
##			
##			The front page can be configured to display as requested the following
##			- Newest Vehicle (configurable number)
##			- Last Updated Vehicle (configurable number)
##			- Newest Modification (configurable number)
##			- Last Updated Modification (configurable number)
##			- Most Modified (configurable number)
##			- Most Money Spent (configurable number)
##			- Featured Vehicle (set vehicle or a random one)
##			- Top Rated Vehicle (configurable number)
##			- Top 1/4 Mile Vehicle (configurable number)
##			- Last Commented Vehicle (configurable number)
##			
##			A complete premissions systems is available...allowing you to select what users can do.
##
##			This mod also provides a 1/4 table see http://www.imoc.co.uk/forums/garage.php?mode=quartermile
##			Each time is taking from vehicles in the garage and requires approval to stop messing
##			Approval is via a link that dynamically appears at the bottom of any page if a time requires it.
##
##			This mod also provides an insurance,garage,shop review page. Users Can Add Business's Themselves.
##			Although for the business to appear in a review page the moderator must approve it.
##
## MOD Version:		1.2.0 
## 
## Installation Level:	Easy
## Installation Time:	10 Minutes
## Files To Edit: (13)
## 			viewtopic.php
## 			viewonline.php
## 			includes/constants.php
## 			includes/page_header.php
## 			includes/page_tail.php
## 			includes/usercp_viewprofile.php
##			language/lang_english/lang_admin.php
##			language/lang_english/lang_main.php
## 			templates/subSilver/subSilver.cfg
## 			templates/subSilver/viewtopic_body.tpl
## 			templates/subSilver/overall_footer.tpl
##			templates/subSilver/overall_header.tpl
##			templates/subSilver/profile_view_body.tpl
##
## Included Files: (89)
##			Install Garage.txt
##			READ ME FIRST.txt
##			Upgrade.txt
##			contrib/Install Garage PCP.txt
##			contrib/profilcp/
##			contrib/templates/
## 			root/garage.php
## 			root/install_garage.php
##			root/admin/admin_garage_business.php
##			root/admin/admin_garage_categories.php
##			root/admin/admin_garage_config.php
##			root/admin/admin_garage_models.php
##			root/admin/admin_garage_permissions.php
##			root/admin/admin_garage_tools.php
##			root/includes/functions_garage.php
##			root/language/lang_english/lang_garage.php
##			root/language/lang_english/lang_garage_error.php
##			root/templates/subSilver/garage.tpl
##			root/templates/subSilver/garage_browse.tpl
##			root/templates/subSilver/garage_browse_insurance.tpl
##			root/templates/subSilver/garage_edit_comment.tpl
##			root/templates/subSilver/garage_error.tpl
##			root/templates/subSilver/garage_footer.tpl
##			root/templates/subSilver/garage_header.tpl
##			root/templates/subSilver/garage_insurance.tpl
##			root/templates/subSilver/garage_manage_vehicle_gallery.tpl
##			root/templates/subSilver/garage_menu.tpl
##			root/templates/subSilver/garage_modification.tpl
##			root/templates/subSilver/garage_pending.tpl
##			root/templates/subSilver/garage_quartermile.tpl
##			root/templates/subSilver/garage_quartermile_table.tpl
##			root/templates/subSilver/garage_reassign_business.tpl
##			root/templates/subSilver/garage_rollingroad.tpl
##			root/templates/subSilver/garage_rollingroad_table.tpl
##			root/templates/subSilver/garage_search.tpl
##			root/templates/subSilver/garage_user_submit.tpl
##			root/templates/subSilver/garage_user_submit_make.tpl
##			root/templates/subSilver/garage_user_submit_model.tpl
##			root/templates/subSilver/garage_vehicle.tpl
##			root/templates/subSilver/garage_vehicle_select_javascript.tpl
##			root/templates/subSilver/garage_view_garage_business.tpl
##			root/templates/subSilver/garage_view_guestbook.tpl
##			root/templates/subSilver/garage_view_insurance_business.tpl
##			root/templates/subSilver/garage_view_modification.tpl
##			root/templates/subSilver/garage_view_shop_business.tpl
##			root/templates/subSilver/garage_view_vehicle.tpl
##			root/templates/subSilver/admin/garage_business.tpl
##			root/templates/subSilver/admin/garage_business_edit.tpl
##			root/templates/subSilver/admin/garage_category.tpl
##			root/templates/subSilver/admin/garage_category_delete_body.tpl
##			root/templates/subSilver/admin/garage_category_edit_body.tpl
##			root/templates/subSilver/admin/garage_config.tpl
##			root/templates/subSilver/admin/garage_message.tpl
##			root/templates/subSilver/admin/garage_model.tpl
##			root/templates/subSilver/admin/garage_model_delete.tpl
##			root/templates/subSilver/admin/garage_model_edit.tpl
##			root/templates/subSilver/admin/garage_orphans.tpl
##			root/templates/subSilver/admin/garage_permissions.tpl
##			root/templates/subSilver/admin/garage_tools.tpl
##			root/templates/subSilver/images/garage_camera.gif
##			root/templates/subSilver/images/garage_slip.gif
##			root/templates/subSilver/images/lang_english/garage_add_insurance.gif
##			root/templates/subSilver/images/lang_english/garage_add_modification.gif
##			root/templates/subSilver/images/lang_english/garage_add_quartermile.gif
##			root/templates/subSilver/images/lang_english/garage_add_rollingroad.gif
##			root/templates/subSilver/images/lang_english/garage_browse.gif
##			root/templates/subSilver/images/lang_english/garage_create_vehicle.gif
##			root/templates/subSilver/images/lang_english/garage_delete.gif
##			root/templates/subSilver/images/lang_english/garage_delete_vehicle.gif
##			root/templates/subSilver/images/lang_english/garage_edit.gif
##			root/templates/subSilver/images/lang_english/garage_edit_vehicle.gif
##			root/templates/subSilver/images/lang_english/garage_garage_review.gif
##			root/templates/subSilver/images/lang_english/garage_insurance_review.gif
##			root/templates/subSilver/images/lang_english/garage_main_menu.gif
##			root/templates/subSilver/images/lang_english/garage_main_vehicle.gif
##			root/templates/subSilver/images/lang_english/garage_manage_gallery.gif
##			root/templates/subSilver/images/lang_english/garage_no_thumb.gif
##			root/templates/subSilver/images/lang_english/garage_quartermile_table.gif
##			root/templates/subSilver/images/lang_english/garage_rollingroad_table.gif
##			root/templates/subSilver/images/lang_english/garage_search.gif
##			root/templates/subSilver/images/lang_english/garage_shop_review.gif
##			root/templates/subSilver/images/lang_english/garage_view_vehicle.gif
##			root/templates/subSilver/images/lang_english/icon_garage.gif
##			upgrade/upgrade_garage-1.0.0.txt
##			upgrade/upgrade_garage-1.0.0.php
##			upgrade/upgrade_garage-1.0.2.txt
##			upgrade/upgrade_garage-1.0.2.php
##			upgrade/upgrade_garage-1.0.3.txt
##			upgrade/upgrade_garage-1.0.3.php
## License: http://opensource.org/licenses/gpl-license.php GNU General Public License v2 or any later version
######################################################################################
## For security purposes, please check: http://www.phpbb.com/mods/
## for the latest version of this MOD. Although MODs are checked
## before being allowed in the MODs Database there is no guarantee
## that there are no security problems within the MOD. No support
## will be given for MODs not found within the MODs Database which
## can be found at http://www.phpbb.com/mods/
###################################################################################### 
## Author Notes: 
##
##	- This Mod Was Inspired By IPB Based Garage By Matthew C. Veno
##
######################################################################################
## MOD History: 
##   xx-xx-2006 - Version 1.2.0
##	- Add 'DENY' permission
##	- Add vehicle quotas by group
## 	- Add upload image quotas by group
## 	- Add remote image quotas by group
## 	- Add disk space limits
##
##   18-04-2006 - Version 1.0.3
##	- Add support for MySQL5
##
##   27-02-2006 - Version 1.0.2
##	- Fix javascript error on adding a new model
##	- Fix setting private permissions
##	- Fix offset year
##	- Fix userlink in viewing insurance business
##
##   01-02-2006 - Version 1.0.0
##	- Version Submitted To phpBB.com's MOD DB. (Resubmitted with changes 01-02-2006)
##	- Version Submitted To phpBB.com's MOD DB. (Resubmitted with one change 08-01-2006)
##
###################################################################################### 
## Before Adding This MOD To Your Forum, You Should Back Up All Files Related To This MOD 
###################################################################################### 

#
#-----[ COPY ]------------------------------------------
#
copy root/*.* TO *.*

#
#-----[ DIY INSTRUCTIONS ]------------------------------------------
#
Create directory ./garage 
Create directory ./garage/upload 
Chmod ./garage/ to 755
Chmod ./garage/upload to 777
Open your web browser and run install_garage.php
Delete install_garage.php if it ran succesfully

# 
#-----[ OPEN ]----- 
# 
viewtopic.php

#
#-----[ FIND ]------------------------------------------
#
<?php
#
#-----[ AFTER, ADD ]------------------------------------------
#
//-- mod : Garage ----------------------------------------------------------------------------------------------------------
#
#-----[ FIND ]------------------------------------------
#
# this is a partial search : the full line is longer
//
// Go ahead and pull all data for this topic
//
#
#-----[ AFTER, ADD ]------------------------------------------
#
//-- mod start : Garage ----------------------------------------------------------------------------------------------------
//-- modify
#
#-----[ FIND ]------------------------------------------
#
# this is a partial search : the full line is longer
$sql = "SELECT u.username, u.user_id, u.user_posts, u.user_from
#
#-----[ IN-LINE FIND ]------------------------------------------
#

pt.post_text, pt.post_subject, pt.bbcode_uid

#
#-----[ IN-LINE AFTER, ADD ]------------------------------------------
#
, g.made_year, makes.make, models.model, g.id as garage_id
#
#-----[ FIND ]------------------------------------------
#
	FROM " . POSTS_TABLE . " p, " . USERS_TABLE . " u, " . POSTS_TEXT_TABLE . " pt
#
#-----[ IN-LINE FIND ]------------------------------------------
#
FROM

#
#-----[ IN-LINE AFTER,ADD ]------------------------------------------
#
 (
#
#-----[ IN-LINE FIND ]------------------------------------------
#
pt

#
#-----[ IN-LINE AFTER,ADD ]------------------------------------------
#
 )

#
#-----[ AFTER, ADD ]------------------------------------------
#
		LEFT JOIN " . GARAGE_TABLE ." g ON ( g.member_id = p.poster_id and g.main_vehicle = 1)
                LEFT JOIN " . GARAGE_MAKES_TABLE . " makes ON (g.make_id = makes.id)
                LEFT JOIN " . GARAGE_MODELS_TABLE . " models ON (g.model_id = models.id)
#
#-----[ FIND ]------------------------------------------
#
	LIMIT $start, ".$board_config['posts_per_page'];
#
#-----[ AFTER, ADD ]------------------------------------------
#
//-- mod finish : Garage ---------------------------------------------------------------------------------------------------

#
#-----[ FIND ]------------------------------------------
#

	$poster_from = ( $postrow[$i]['user_from'] && $postrow[$i]['user_id'] != ANONYMOUS ) ? $lang['Location'] . ': ' . $postrow[$i]['user_from'] : '';

#
#-----[ AFTER, ADD ]------------------------------------------
#
//-- mod start : Garage ----------------------------------------------------------------------------------------------------
//-- add
	$garage_id = $postrow[$i]['garage_id'];
	$poster_car_year = ( $postrow[$i]['made_year'] && $postrow[$i]['user_id'] != ANONYMOUS ) ? $lang[''] . ' ' . $postrow[$i]['made_year'] : '';
	$poster_car_make = ( $postrow[$i]['make'] && $postrow[$i]['user_id'] != ANONYMOUS ) ? $lang[''] . ' ' . $postrow[$i]['make'] : '';
	$poster_car_model = ( $postrow[$i]['model'] && $postrow[$i]['user_id'] != ANONYMOUS ) ? $lang[''] . ' ' . $postrow[$i]['model'] : '';
//-- mod finish : Garage ---------------------------------------------------------------------------------------------------
#
#-----[ FIND ]------------------------------------------
#
		'POSTER_FROM' => $poster_from,

#
#-----[ AFTER, ADD ]------------------------------------------
#
//-- mod start : Garage ----------------------------------------------------------------------------------------------------
//-- add
		'POSTER_CAR_MAKE' => $poster_car_make,
		'POSTER_CAR_MODEL' => $poster_car_model,
		'POSTER_CAR_YEAR' => $poster_car_year,
		'VIEW_POSTER_CARPROFILE' => ($userdata['user_level'] != ADMIN)? append_sid("garage.$phpEx?mode=view_vehicle&amp;CID=" . $garage_id) : append_sid("garage.$phpEx?mode=view_vehicle&amp;CID=" . $garage_id) ,
//-- mod finish : Garage ---------------------------------------------------------------------------------------------------
# 
#-----[ OPEN ]----- 
# 
viewonline.php

#
#-----[ FIND ]------------------------------------------
#
<?php

#
#-----[ AFTER, ADD ]------------------------------------------
#
//-- mod : Garage ----------------------------------------------------------------------------------------------------------
# 
#-----[ FIND ]----- 
# 
				case PAGE_FAQ:
					$location = $lang['Viewing_FAQ'];
					$location_url = "faq.$phpEx";
					break;
#
#-----[ AFTER, ADD ]------------------------------------------
#
//-- mod start : Garage ----------------------------------------------------------------------------------------------------
//-- add
				case PAGE_GARAGE:
					$location = $lang['Viewing_Garage'];
					$location_url = "garage.$phpEx";
					break;
//-- mod finish : Garage ---------------------------------------------------------------------------------------------------
# 
#-----[ OPEN ]----- 
# 
includes/constants.php

#
#-----[ FIND ]------------------------------------------
#
<?php

#
#-----[ AFTER, ADD ]------------------------------------------
#
//-- mod : Garage ----------------------------------------------------------------------------------------------------------
#
#-----[ FIND ]------------------------------------------
#
?>

#
#-----[ BEFORE, ADD ]------------------------------------------
#
//-- mod start : Garage ----------------------------------------------------------------------------------------------------
//-- add
define('GARAGE_TABLE', $table_prefix.'garage');
define('GARAGE_CONFIG_TABLE', $table_prefix.'garage_config');
define('GARAGE_CATEGORIES_TABLE', $table_prefix.'garage_categories');
define('GARAGE_GALLERY_TABLE', $table_prefix.'garage_gallery');
define('GARAGE_GUESTBOOKS_TABLE', $table_prefix.'garage_guestbooks');
define('GARAGE_IMAGES_TABLE', $table_prefix.'garage_images');
define('GARAGE_MAKES_TABLE', $table_prefix.'garage_makes');
define('GARAGE_MODELS_TABLE', $table_prefix.'garage_models');
define('GARAGE_MODS_TABLE', $table_prefix.'garage_mods');
define('GARAGE_QUARTERMILE_TABLE', $table_prefix.'garage_quartermile');
define('GARAGE_ROLLINGROAD_TABLE', $table_prefix.'garage_rollingroad');
define('GARAGE_BUSINESS_TABLE', $table_prefix.'garage_business');
define('GARAGE_INSURANCE_TABLE', $table_prefix.'garage_insurance');
define('GARAGE_RATING_TABLE', $table_prefix.'garage_rating');
define('GARAGE_VEHICLE_FIELDS_TABLE', $table_prefix.'garage_vehicle_fields');
define('GARAGE_VEHICLE_FIELDS_DATA_TABLE', $table_prefix.'garage_vehicle_fields_data');
define('GARAGE_VEHICLE_FIELDS_LANG_TABLE', $table_prefix.'garage_vehicle_fields_lang');
define('GARAGE_VEHICLE_LANG_TABLE', $table_prefix.'garage_vehicle_lang');
define('GARAGE_UPLOAD_PATH', 'garage/upload/');
define('PAGE_GARAGE', -2120);
//-- mod finish : Garage ---------------------------------------------------------------------------------------------------
# 
#-----[ OPEN ]----- 
# 
includes/page_header.php

#
#-----[ FIND ]------------------------------------------
#
<?php

#
#-----[ AFTER, ADD ]------------------------------------------
#
//-- mod : Garage ----------------------------------------------------------------------------------------------------------
#
#-----[ FIND ]------------------------------------------
#
	'L_FAQ' => $lang['FAQ'],
#
#-----[ AFTER, ADD ]------------------------------------------
#
//-- mod start : Garage ----------------------------------------------------------------------------------------------------
//-- add
	'L_GARAGE' => $lang['Garage'],
	'L_QUARTERMILE_TABLE' => $lang['Quartermile_Table'],
	'U_GARAGE' => append_sid("garage.$phpEx"),
	'U_QUARTERMILE' => append_sid("garage.$phpEx?mode=quartermile"),
//-- mod finish : Garage ---------------------------------------------------------------------------------------------------
# 
#-----[ OPEN ]----- 
# 
includes/page_tail.php

#
#-----[ FIND ]------------------------------------------
#
<?php
#
#-----[ AFTER, ADD ]------------------------------------------
#
//-- mod : Garage ----------------------------------------------------------------------------------------------------------
# 
#-----[ FIND ]----- 
# 
$admin_link = ( $userdata['user_level'] == ADMIN ) ? '<a href="admin/index.' . $phpEx . '?sid=' . $userdata['session_id'] . '">' . $lang['Admin_panel'] . '</a><br /><br />' : '';
#
#-----[ AFTER, ADD ]------------------------------------------
#

//-- mod start : Garage ----------------------------------------------------------------------------------------------------
//-- add
include_once($phpbb_root_path . 'includes/class_garage.' . $phpEx);
if ( in_array($userdata['user_level'], array(ADMIN, MOD)) )
{
	//If Pending Items Exist Then Create Link
	if ( $garage->check_pending_items() )
	{
		$temp_url = append_sid("garage.$phpEx?mode=garage_pending");
		$pending_link = '<a href="'.$temp_url.'">' . $lang['Pending_Items'] . '</a>&nbsp;&nbsp;';
		$template->assign_vars(array(
			'PENDING_LINK' => $pending_link)
		);
	}
}
//-- mod finish : Garage ---------------------------------------------------------------------------------------------------

# 
#-----[ OPEN ]----- 
# 
includes/usercp_viewprofile.php

#
#-----[ FIND ]------------------------------------------
#
<?php

#
#-----[ AFTER, ADD ]------------------------------------------
#
//-- mod : Garage ----------------------------------------------------------------------------------------------------------
#
#-----[ FIND ]------------------------------------------
#
make_jumpbox('viewforum.'.$phpEx);
#
#-----[ AFTER, ADD ]------------------------------------------
#

//-- mod start : Garage ----------------------------------------------------------------------------------------------------
//-- add
//Setup Garage Language Files...
if(empty($board_config['default_lang']))
{
	$board_config['default_lang'] = 'english';
}
require($phpbb_root_path . 'language/lang_' . $board_config['default_lang'] . '/lang_garage.' . $phpEx);
require($phpbb_root_path . 'language/lang_' . $board_config['default_lang'] . '/lang_garage_error.' . $phpEx);
require($phpbb_root_path . 'includes/class_garage.' . $phpEx);
require($phpbb_root_path . 'includes/class_garage_image.' . $phpEx);

$sql = "SELECT g.*, images.*, makes.make, models.model, user.username, user.user_avatar_type,
	user.user_allowavatar, user.user_avatar,
        count(mods.id) AS total_mods,  
        ( SUM(mods.price) + SUM(mods.install_price) ) AS total_spent 
        FROM " . GARAGE_TABLE . " g  
		LEFT JOIN " . USERS_TABLE ." user ON (g.member_id = user.user_id)
                LEFT JOIN " . GARAGE_MODS_TABLE . " mods ON (g.id = mods.garage_id)
                LEFT JOIN " . GARAGE_MAKES_TABLE . " makes ON (g.make_id = makes.id)
                LEFT JOIN " . GARAGE_MODELS_TABLE . " models ON (g.model_id = models.id)
		LEFT JOIN " . GARAGE_IMAGES_TABLE . " images ON (images.attach_id = g.image_id)
        WHERE g.member_id = " . $profiledata['user_id'] . " AND g.main_vehicle = 1
        GROUP BY g.id";

if ( !($result = $db->sql_query($sql)) )
{
       	message_die(GENERAL_ERROR, 'Could Not Select Vehicle Data', '', __LINE__, __FILE__, $sql);
}

$vehicle_row = $db->sql_fetchrow($result);

if ( $db->sql_numrows($result) > 0 )
{
	$template->assign_block_vars('garage_vehicle', array());
	$total_spent = $vehicle_row['total_spent'] ? $vehicle_row['total_spent'] : 0;

	//Display Just Thumbnails Of All Images Or Just One Main Image
	if ( $garage_config['profile_thumbs'] == 1 )
	{

		$gallery_data = $garage_image->select_gallery_data($vehicle_row['id']);
        	for ( $i=0; $i < count($gallery_data); $i++ )
	       	{
            		if ( $gallery_data[$i]['attach_is_image'] )
           		{
                		// Do we have a thumbnail?  If so, our job is simple here :)
				if ( (empty($gallery_data[$i]['attach_thumb_location']) == FALSE) AND ($gallery_data[$i]['attach_thumb_location'] != $gallery_data[$i]['attach_location']) AND ( $vehicle_images_found <= 12) )
                		{
                    			// Form the image link
					$thumb_image = GARAGE_UPLOAD_PATH . $gallery_data[$i]['attach_thumb_location'];
					$id = $gallery_data[$i]['attach_id'];
					$title = $gallery_data[$i]['attach_file'];
					$hilite_image .= '<a href=garage.php?mode=view_gallery_item&amp;type=garage_gallery&amp;image_id='. $id .' title=' . $title .' target="_blank"><img hspace="5" vspace="5" src="' . $thumb_image .'" class="attach"  /></a> ';
               			} 
			}
	        }

		$mod_query = "SELECT m.*,images.attach_id, images.attach_hits, images.attach_ext, 
                        images.attach_file, images.attach_thumb_location, images.attach_is_image,
                        images.attach_location
         		FROM " . GARAGE_MODS_TABLE . " m
                        LEFT JOIN " . GARAGE_IMAGES_TABLE . " images ON (images.attach_id = m.image_id)
	       		WHERE m.garage_id = " . $vehicle_row['id'] .";";
		if ( !($result = $db->sql_query($mod_query)) )
      		{
         		message_die(GENERAL_ERROR, 'Could Not Select Image Data For Vehicle', '', __LINE__, __FILE__, $sql);
	      	}

        	while ( $mod_gallery = $db->sql_fetchrow($result) )
	       	{
            		if ( $mod_gallery['attach_is_image'] )
           		{
                		// Do we have a thumbnail?  If so, our job is simple here :)
				if ( (empty($mod_gallery['attach_thumb_location']) == FALSE) AND ($mod_gallery['attach_thumb_location'] != $gallery_data['attach_location']) AND ( $vehicle_images_found <= 12) )
                		{
                    			// Form the image link
					$thumb_image = GARAGE_UPLOAD_PATH . $mod_gallery['attach_thumb_location'];
					$id = $mod_gallery['attach_id'];
					$title = $mod_gallerya['attach_file'];
					$hilite_image .= '<a href=garage.php?mode=view_gallery_item&amp;type=garage_gallery&amp;image_id='. $id .' title=' . $title .' target="_blank"><img hspace="5" vspace="5" src="' . $thumb_image .'" class="attach"  /></a> ';
               			} 
			}
	        }
	}
	//Looks Like We Only Need To Draw One Main Image
	else
	{
		if ( ($vehicle_row['image_id']) AND ($vehicle_row['attach_is_image']) AND (!empty($vehicle_row['attach_thumb_location'])) AND (!empty($vehicle_row['attach_location'])) )
		{
			// Check to see if this is a remote image
			if ( preg_match( "/^http:\/\//i", $vehicle_row['attach_location']) )
			{
				$image = $vehicle_row['attach_location'];
				$id = $vehicle_row['attach_id'];
				$title = $vehicle_row['attach_file'];
				$total_image_views = $vehicle_row['attach_hits'];
				$hilite_image = '<a href=garage.php?mode=view_gallery_item&amp;type=garage_mod&amp;image_id='. $id .' title=' . $title .' target="_blank"><img hspace="5" vspace="5" src="' . $image .'" class="attach"  /></a>';
			}
			else
			{
				$image = GARAGE_UPLOAD_PATH . $vehicle_row['attach_location'];
				$id = $vehicle_row['attach_id'];
				$title = $vehicle_row['attach_file'];
				$total_image_views = $vehicle_row['attach_hits'];
				$hilite_image = '<a href=garage.php?mode=view_gallery_item&amp;type=garage_mod&amp;image_id='. $id .' title=' . $title .' target="_blank"><img hspace="5" vspace="5" src="' . $image .'" class="attach"  /></a>';
			}
		}
	}

	$garage_img ='<a href="' . append_sid("garage.$phpEx?mode=browse&search=yes&user=".urlencode($profiledata['username'])."") . '"><img src="' . $images['icon_garage'] . '" alt="'.$lang['Garage'].'" title="'.$lang['Garage'].'" border="0" /></a>';

	$template->assign_vars(array(
		'L_VEHICLE' => $lang['Vehicle'],
		'L_GARAGE' => $lang['Garage'],
		'L_COLOUR' => $lang['Colour'],
		'L_MILEAGE' => $lang['Mileage'],
		'L_PRICE' => $lang['Purchased_Price'],
		'L_TOTAL_MODS' => $lang['Total_Mods'],
		'L_TOTAL_SPENT' => $lang['Total_Spent'],
		'L_DESCRIPTION' => $lang['Description'],
		'L_SEARCH_USER_GARAGE' => $lang['Search_User_Garage'],
		'YEAR' => $vehicle_row['year'],
		'MAKE' => $vehicle_row['make'],
		'MODEL' => $vehicle_row['model'],
       		'COLOUR' => $vehicle_row['color'],
	       	'HILITE_IMAGE' => $hilite_image,
        	'MILEAGE' => $vehicle_row['mileage'],
	        'MILEAGE_UNITS' => $vehicle_row['mileage_unit'],
        	'PRICE' => $vehicle_row['price'],
	        'CURRENCY' => $vehicle_row['currency'],
        	'TOTAL_MODS' => $vehicle_row['total_mods'],
	        'TOTAL_SPENT' => $total_spent,
        	'TOTAL_VIEWS' => $vehicle_row['views'],
	        'DESCRIPTION' => $vehicle_row['comments'],
	        'GARAGE_IMG' => $garage_img,
		'U_SEARCH_USER_GARAGE' => append_sid("garage.$phpEx?mode=browse"))
	);
}
//-- mod finish: Garage ----------------------------------------------------------------------------------------------------
# 
#-----[ OPEN ]------------------------------------------
# 
language/lang_english/lang_admin.php

#
#-----[ FIND ]------------------------------------------
#
<?php

#
#-----[ AFTER, ADD ]------------------------------------
#
//-- mod : Garage ----------------------------------------------------------------------------------------------------------
#
#-----[ FIND ]------------------------------------------
#
?>

#
#-----[ BEFORE, ADD ]------------------------------------
#
//-- mod start : Garage ----------------------------------------------------------------------------------------------------
//-- add
$lang['Business'] = 'Business';
$lang['Categories'] = 'Categories';
$lang['Configuration'] = 'Configuration';
$lang['Makes & Models'] = 'Makes & Models';
$lang['Permissions'] = 'Permissions';
$lang['Tools'] = 'Tools';
//-- mod finish : Garage ---------------------------------------------------------------------------------------------------

# 
#-----[ OPEN ]----- 
# 
language/lang_english/lang_main.php

#
#-----[ FIND ]------------------------------------------
#
<?php

#
#-----[ AFTER, ADD ]------------------------------------------
#
//-- mod : Garage ----------------------------------------------------------------------------------------------------------
# 
#-----[ FIND ]----- 
# 
 
//
// That's all, Folks!
// -------------------------------------------------

#
#-----[ BEFORE, ADD ]------------------------------------------
#

//-- mod start : Garage ----------------------------------------------------------------------------------------------------
//-- add
$lang['Garage'] = 'Garage';
$lang['Viewing_Garage'] = 'Viewing Garage';
$lang['Quartermile_Table'] = '1/4 Mile Table';
$lang['Pending_Items'] = 'View Pending Garage Items';
//-- mod finish : Garage ---------------------------------------------------------------------------------------------------

# 
#-----[ OPEN ]----- 
# 
templates/subSilver/viewtopic_body.tpl

#
#-----[ FIND ]------------------------------------------
#
# this is a partial search : the full line is longer
{postrow.POSTER_JOINED}<br />{postrow.POSTER_POSTS}<br />{postrow.POSTER_FROM}
#
#-----[ IN-LINE FIND ]------------------------------------------
#
{postrow.POSTER_FROM}
#
#-----[ IN-LINE AFTER, ADD ]------------------------------------------
#

<br /><br /><a href="{postrow.VIEW_POSTER_CARPROFILE}" >{postrow.POSTER_CAR_YEAR} {postrow.POSTER_CAR_MAKE} {postrow.POSTER_CAR_MODEL}</a>

# 
#-----[ OPEN ]----- 
# 
templates/subSilver/overall_footer.tpl

#
#-----[ FIND ]------------------------------------------
#
<div align="center"><span class="copyright"><br />
#
#-----[ IN-LINE FIND ]------------------------------------------
#
<span class="copyright"><br />
#
#-----[ IN-LINE AFTER, ADD ]------------------------------------------
#

{PENDING_LINK}

# 
#-----[ OPEN ]----- 
# 
templates/subSilver/overall_header.tpl

#
#-----[ FIND ]------------------------------------------
#
<td align="center" valign="top" nowrap="nowrap"><span class="mainmenu">
#
#-----[ IN-LINE FIND ]------------------------------------------
#
<span class="mainmenu">&nbsp;
#
#-----[ IN-LINE AFTER, ADD ]------------------------------------------
#
<a href="{U_GARAGE}" class="mainmenu"><img src="templates/subSilver/images/icon_mini_members.gif" width="12" height="13" border="0" alt="{L_GARAGE}" hspace="3" />{L_GARAGE}</a>&nbsp; &nbsp;<a href="{U_QUARTERMILE}" class="mainmenu"><img src="templates/subSilver/images/icon_mini_members.gif" width="12" height="13" border="0" alt="{L_QUARTERMILE_TABLE}" hspace="3" />{L_QUARTERMILE_TABLE}</a>&nbsp; &nbsp;
# 
#-----[ OPEN ]----- 
# 
templates/subSilver/profile_view_body.tpl

#
#-----[ FIND ]------------------------------------------
#
		  //--></script><noscript>{ICQ_IMG}</noscript></td>
		</tr>
#
#-----[ AFTER, ADD ]------------------------------------------
#
	<!-- BEGIN garage_vehicle -->
		<tr> 
			<td valign="middle" nowrap="nowrap" align="right"><span class="gen">{L_GARAGE}:</span></td>
			<td class="row1" valign="middle"><span class="gen">{GARAGE_IMG}</span></td>
		</tr>
  	<!-- END garage_vehicle -->
#
#-----[ FIND ]------------------------------------------
#
	  </table>
	</td>
  </tr>
#
#-----[ AFTER, ADD ]------------------------------------------
#
  <!-- BEGIN garage_vehicle -->
  <tr> 
	<td class="catLeft" align="center" height="28" colspan="2"><b><span class="gen">{USERNAME}'s {L_VEHICLE}</span></b></td>
  </tr>
  <tr>
	<td class='row1' colspan="2"><span class="gen"><b>{L_VEHICLE}</b> : {YEAR} {MAKE} {MODEL}</span></td>
  </tr>
  <tr>
	<td class='row1' colspan="2"><span class="gen"><b>{L_COLOUR} </b> : {COLOUR} </span></td>
  </tr>
  <tr>
	<td class='row1' colspan="2"><span class="gen"><b>{L_MILEAGE}</b> : {MILEAGE} {MILEAGE_UNITS}</span></td>
  </tr>
  <tr>
        <td class='row1' colspan="2"><span class="gen"><b>{L_PRICE}</b> : {PRICE} {CURRENCY}</span></td>
  </tr>
  <tr>
        <td class='row1' colspan="2"><span class="gen"><b>{L_TOTAL_MODS}</b> : {TOTAL_MODS}</span></td>
  </tr>
  <tr>
        <td class='row1' colspan="2"><span class="gen"><b>{L_TOTAL_SPENT}</b> : {TOTAL_SPENT} {CURRENCY}</span></td>
  </tr>
  <tr>
        <td class='row1' colspan="2"><span class="gen"><b>{L_DESCRIPTION}</b> : {DESCRIPTION}</span></td>
  </tr>
  <tr> 
	<td class="row1" valign="middle" align="left" colspan="2"><span class="gen">{HILITE_IMAGE}</span></td>
  </tr>
  <!-- END garage_vehicle -->
# 
#-----[ OPEN ]----- 
# 
templates/subSilver/subSilver.cfg

#
#-----[ FIND ]------------------------------------------
#
<?php

#
#-----[ AFTER, ADD ]------------------------------------------
#
//-- mod : Garage ----------------------------------------------------------------------------------------------------------
#
#-----[ FIND ]------------------------------------------
#
?>
#
#-----[ BEFORE, ADD ]------------------------------------------
#

//-- mod start : Garage ----------------------------------------------------------------------------------------------------
//-- add
$images['vehicle_image_attached']	= "$current_template_images/garage_camera.gif";
$images['slip_image_attached']		= "$current_template_images/garage_slip.gif";
$images['icon_garage']			= "$current_template_images/{LANG}/icon_garage.gif";
$images['garage_main_menu']		= "$current_template_images/{LANG}/garage_main_menu.gif";
$images['garage_browse']		= "$current_template_images/{LANG}/garage_browse.gif";
$images['garage_search']		= "$current_template_images/{LANG}/garage_search.gif";
$images['garage_quartermile_table']	= "$current_template_images/{LANG}/garage_quartermile_table.gif";
$images['garage_rollingroad_table']	= "$current_template_images/{LANG}/garage_rollingroad_table.gif";
$images['garage_garage_review']		= "$current_template_images/{LANG}/garage_garage_review.gif";
$images['garage_shop_review']		= "$current_template_images/{LANG}/garage_shop_review.gif";
$images['garage_insurance_review']	= "$current_template_images/{LANG}/garage_insurance_review.gif";
$images['garage_create_vehicle']	= "$current_template_images/{LANG}/garage_create_vehicle.gif";
$images['garage_edit_vehicle']		= "$current_template_images/{LANG}/garage_edit_vehicle.gif";
$images['garage_delete_vehicle']	= "$current_template_images/{LANG}/garage_delete_vehicle.gif";
$images['garage_view_vehicle']		= "$current_template_images/{LANG}/garage_view_vehicle.gif";
$images['garage_add_modification']	= "$current_template_images/{LANG}/garage_add_modification.gif";
$images['garage_add_insurance']		= "$current_template_images/{LANG}/garage_add_insurance.gif";
$images['garage_add_rollingroad']	= "$current_template_images/{LANG}/garage_add_rollingroad.gif";
$images['garage_add_quartermile']	= "$current_template_images/{LANG}/garage_add_quartermile.gif";
$images['garage_manage_gallery']	= "$current_template_images/{LANG}/garage_manage_gallery.gif";
$images['garage_edit']			= "$current_template_images/{LANG}/garage_edit.gif";
$images['garage_delete']		= "$current_template_images/{LANG}/garage_delete.gif";
$images['garage_main_vehicle']		= "$current_template_images/{LANG}/garage_main_vehicle.gif";
$images['garage_no_thumb']		= "$current_template_images/{LANG}/garage_no_thumb.gif";
$images['garage_show_details']		= "$current_template_images/{LANG}/garage_show_details.gif";
$images['garage_hide_details']		= "$current_template_images/{LANG}/garage_hide_details.gif";
$images['garage_move_up']		= "$current_template_images/{LANG}/garage_move_up.gif";
$images['garage_move_down']		= "$current_template_images/{LANG}/garage_move_down.gif";
$images['garage_set_approved']		= "$current_template_images/{LANG}/garage_set_approved.gif";
$images['garage_set_pending']		= "$current_template_images/{LANG}/garage_set_pending.gif";
//-- mod finish : Garage ---------------------------------------------------------------------------------------------------

#
#-----[ SAVE/CLOSE ALL FILES ]------------------------------------------
#
# EoM
