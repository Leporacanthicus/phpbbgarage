<!-- INCLUDE overall_header.html -->
<script type="text/javascript" src="{T_TEMPLATE_PATH}/garage_ajax.js"></script>
<script type="text/javascript">
var ajax = new sack();

//Function To Build Product Dropdown
function get_product_list(sel)
{
	//Get Selected Product Manufacturer
	var manufacturer_id = sel.options[sel.selectedIndex].value;

	//We Need To Make Sure A Category Is Selected
	if (document.modification.elements['category_id'].value < 1)
	{
		formErrors = "{L_EMPTY_TITLE}";
		if (formErrors) 
		{
			//We Need To Set Manufaucture Dropdown Back To Select Message
			// PLACE CODE HERE ;)
			alert(formErrors);
		} 
	}

	//Since We Know We Have A Valid Category Selected Save It
	var category_id = document.modification.elements['category_id'].value;

	//Set The Product List To Empty Ready To Recieve Options
	document.getElementById('product_id').options.length = 0;

	//Call Script To Run Products Based On Category & Manufacturer
	ajax.requestFile = 'garage.php?mode=get_product_list&category_id='+category_id+'&manufacturer_id='+manufacturer_id;
	ajax.onCompletion = build_product_list;
	ajax.runAJAX();
}

//Function Used For Inital Page Display On Editting Modification To Build Correctly Selected Dropdowns
function update_product_list(category_id, manufacturer_id, product_id)
{
	document.getElementById('product_id').options.length = 0;
	ajax.requestFile = 'garage.php?mode=get_product_list&category_id='+category_id+'&manufacturer_id='+manufacturer_id+'&product_id='+product_id;
	ajax.onCompletion = build_product_list;
	ajax.runAJAX();
}

//Update Product List If Manufacturer Is Valid To Show Products For New Category
function category_change(sel)
{
	var category_id = sel.options[sel.selectedIndex].value;
	var manufacturer_id = document.modification.elements['manufacturer_id'].value;

	//If We Have Two Valid Selections Update Prouct List
	if (category_id > 0 && manufacturer_id > 0)
	{
		document.getElementById('product_id').options.length = 0;
		ajax.requestFile = 'garage.php?mode=get_product_list&category_id='+category_id+'&manufacturer_id='+manufacturer_id;
		ajax.onCompletion = build_product_list;
		ajax.runAJAX();
	}

}

//Actually Build The Product Listed Based On Returned Values
function build_product_list()
{
	var obj = document.getElementById('product_id');
	eval(ajax.response);
} 
</script>

<!-- IF U_MCP -->
	<div id="pageheader">
		<p class="linkmcp">[ <a href="{U_MCP}">{L_MCP}</a> ]</p>
	</div>

	<br clear="all" /><br />
<!-- ENDIF -->

<!-- INCLUDE garage_header.html -->

<!-- INCLUDE garage_menu.html -->

<td width="72%" valign="top">
			<form id="modification" enctype="multipart/form-data" method="post" name="modification" action="{S_MODE_ACTION}">
			<table width="100%" cellpadding="3" cellspacing="1" border="0" class="tablebg">
				<tr>
					<th class="thHead" height="25" nowrap="nowrap" colspan="2">{VEHICLE_DATA}</th>
				</tr>
				<tr>
					<td class="cat" align="center" height="25" nowrap="nowrap" colspan="2"><span class="gen">{L_TITLE}</span></td>
				</tr>
				<tr>
					<td class="row1" width="30%"><span class="gen"><b>{L_CATEGORY}</b></span><span class="gensmall"><font color="#FF0000">[{L_REQUIRED}]</font></span></td>
					<td class="row2"><select id="category_id" name="category_id" onchange="category_change(this)" ><option value="">{L_SELECT_CATEGORY}</option><option value="">------</option><!-- BEGIN category--><option value="{category.ID}" <!-- IF category.S_SELECTED -->selected="selected"<!-- ENDIF -->>{category.TITLE}</option><!-- END category --></select>&nbsp;</td>
				</tr>
				<tr>
					<td class="row1" width="30%"><span class="gen"><b>{L_MANUFACTURER}</b></span><span class="gensmall"><font color="#FF0000">[{L_REQUIRED}]</font></span></td>
					<td class="row2"><select id="manufacturer_id" name="manufacturer_id" onchange="get_product_list(this)" ><option value="">{L_SELECT_MANUFACTURER}</option><option value="">------</option><!-- BEGIN manufacturer--><option value="{manufacturer.ID}" <!-- IF manufacturer.S_SELECTED -->selected="selected"<!-- ENDIF -->>{manufacturer.TITLE}</option><!-- END manufacturer --></select>&nbsp;<span class="gensmall">{L_NOT_LISTED_YET}<a href="{U_SUBMIT_BUSINESS_PRODUCT}">{L_HERE}</a></span></td>
				</tr>
				<tr>
					<td class="row1" width="30%"><span class="gen"><b>{L_PRODUCT}</b></span><span class="gensmall"><font color="#FF0000">[{L_REQUIRED}]</font></span></td>
					<td class="row2"><select id="product_id" name="product_id"><option value="">{L_SELECT_PRODUCT}</option><option value="">------</option></select>&nbsp;<span class="gensmall">&nbsp;{L_NOT_LISTED_YET}<a href="{U_SUBMIT_PRODUCT}">{L_HERE}</a>&nbsp;&nbsp;&nbsp;<span class="gen"><b>{L_RATING}</b>&nbsp;</span><span class="gensmall">{PRODUCT_RATINGS}</span></td>
				</tr>
				<tr>
					<td class="row1" width="30%"><span class="gen"><b>{L_PURCHASED_FROM}</b></span></td>
				  	<td class="row2">{SHOP_LIST}&nbsp;<span class="gensmall">{L_NOT_LISTED_YET}<a href="{U_SUBMIT_BUSINESS_SHOP}">{L_HERE}</a></span></td>
				</tr>
				<tr>
					<td class="row1" width="30%"><span class="gen"><b>{L_PURCHASED_PRICE}</b></span></td>
					<td class="row2"><input name="price" type="text" class="post" size="10" value="{PRICE}" /><span class="gen">&nbsp;<b>{L_PURCHASE_RATING}</b>&nbsp;{PURCHASE_RATINGS}</td>
				</tr>
				<tr>
					<td class="row1" width="30%"><span class="gen"><b>{L_INSTALLED_BY}</b></span></td>
				  	<td class="row2">{GARAGE_INSTALL_LIST}&nbsp;<span class="gensmall">{L_NOT_LISTED_YET}<a href="{U_SUBMIT_BUSINESS_GARAGE}">{L_HERE}</a></span></td>
				</tr>
				<tr>
					<td class="row1" width="30%"><span class="gen"><b>{L_INSTALLATION_PRICE}</b></span></td>
					<td class="row2"><input name="install_price" type="text" class="post" size="10" value="{INSTALL_PRICE}" /><span class="gen">&nbsp;<b>{L_INSTALLATION_RATING}</b>&nbsp;{INSTALL_RATINGS}</td>
				</tr>
				<tr>
					<td class="row1" width="30%"><span class="gen"><b>{L_DESCRIPTION}</b></span></td>
					<td class="row2"><textarea name="comments" cols="60" rows="4" wrap="soft"   class="post">{COMMENTS}</textarea></td>
				</tr>
				<tr>
					<td class="row1" width="30%"><span class="gen"><b>{L_INSTALL_COMMENTS}</b></span><br/><span class="gensmall">{L_ONLY_SHOW_IN_REVIEW}</span></td>
					<td class="row2"><textarea name="install_comments" cols="60" rows="4" wrap="soft"   class="post">{INSTALL_COMMENTS}</textarea></td>
				</tr>
				<!-- BEGIN allow_images -->
				<tr>
					<td class="cat" align="center" height="28" colspan="2"><span class="gen">{L_IMAGE_ATTACHMENTS}</span></td>
				</tr>
				<!-- BEGIN keep_image -->
				<tr>
					<td class="row1"></td>
			        	<td class="row2" width="100%"><input type="radio" name="editupload" value="keep" checked />&nbsp;<span class="gen"><b>{L_KEEP_CURRENT_IMAGE}</b> ( {allow_images.keep_image.CURRENT_IMAGE} )</span></td>
				</tr>
				<!-- END keep_image -->
				<!-- BEGIN remove_image -->
				<tr>
					<td class="row1"></td>
             				<td class="row2" width="100%"><input type="radio" name="editupload" value="delete" />&nbsp;<span class="gen"><b>{L_REMOVE_IMAGE}</b></span><input type="hidden" value="{allow_images.remove_image.IMAGE_ID}" name="image_id" /></td>
			        </tr>
				<!-- END remove_image -->
				<!-- BEGIN replace_image_upload -->
				<tr>
					<td class="row1" width="32%"><span class="gen"><b>{L_IMAGE_ATTACH}<br />{L_MAXIMUM_IMAGE_FILE_SIZE} : {MAXIMUM_IMAGE_FILE_SIZE} {L_KBYTES}<br />{L_MAXIMUM_IMAGE_RESOLUTION} : {MAXIMUM_IMAGE_RESOLUTION}</b></span></td>
					<td class="row2"><span class="gen"><input type="radio" name="editupload" value="new" />&nbsp;<b>{L_REPLACE_WITH_NEW_IMAGE}</span><br /><input class="post" size="30"  type="file" size="30" name="FILE_UPLOAD" /></td>
				</tr>
				<!-- END replace_image_upload -->
				<!-- BEGIN upload_images -->
				<tr>
					<td class="row1" width="32%"><span class="gen"><b>{L_IMAGE_ATTACH}<br />{L_MAXIMUM_IMAGE_FILE_SIZE} : {MAXIMUM_IMAGE_FILE_SIZE} {L_KBYTES}<br />{L_MAXIMUM_IMAGE_RESOLUTION} : {MAXIMUM_IMAGE_RESOLUTION}</b></span></td>
					<td class="row2"><input class="post" size="30"  type="file" size="30" name="FILE_UPLOAD" /></td>
				</tr>
				<!-- END upload_images -->
				<!-- BEGIN replace_remote_image -->
				<tr>
					<td class="row1" width="32%"><span class="gen"></b></span></td>
					<td class="row2"><span class="gen"><input type="radio" name="editupload" value="new" />&nbsp;<b>{L_REPLACE_WITH_NEW_REMOTE_IMAGE}</span><br /><input name="url_image" type="text" class="post" size="40" maxlength="255" value="http://" /></td>
				</tr>
				<!-- END replace_remote_image -->
				<!-- BEGIN remote_images -->
				<tr>
					<td class="row1" width="32%"><span class="gen"><b>{L_ENTER_IMAGE_URL}</b></span></td>
					<td class="row2"><input name="url_image" type="text" class="post" size="40" maxlength="255" value="http://" /></td>
				</tr>
				<!-- END remote_images -->
				<!-- END allow_images -->
				<tr>
					<td class="cat" align="center" height="28" colspan="2"><input type="hidden" value="" name="redirect" /><input type="hidden" value="{CID}" name="CID" /><input type="hidden" value="{MID}" name="MID" /><input name="modification" type="submit" value="{L_BUTTON}" class="liteoption" /></td>
				</tr>
			</table>
			</form>
		</td>

<script language="JavaScript" type="text/javascript">
<!--
//Fill The Product Dropdown If We Are Editing + Select Correct One
update_product_list('{CATEGORY_ID}', '{MANUFACTURER_ID}', '{PRODUCT_ID}');

function add_product (redirect)
{
	document.modification.redirect.value = redirect;
	document.modification.action = '{S_MODE_ACTION_PRODUCT}';
	document.modification.submit() ;
}
//-->
</script>

<!-- INCLUDE garage_footer.html -->

<!-- INCLUDE overall_footer.html -->
